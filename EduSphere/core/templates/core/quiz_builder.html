{% extends 'core/base.html' %}

{% block title %}Quiz Builder: {{ quiz.title }}{% endblock %}

{% block content %}
<h2>Quiz Builder: {{ quiz.title }}</h2>
<p class="text-muted">Due Date: {{ quiz.due_date }}</p>
<hr>

<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h4>Questions</h4>
        <div>
            <a href="{% url 'core:quiz_attempts_list' quiz.pk %}" class="btn btn-info">
                View Attempts <span class="badge bg-light text-dark">{{ quiz.attempts.count }}</span>
            </a>
            <a href="{% url 'core:question_create' quiz.pk %}" class="btn btn-primary">Add Question</a>
        </div>
    </div>
    <div class="list-group list-group-flush">
        {% for question in quiz.questions.all %}
        <div class="list-group-item">
            <p><strong>Q{{ forloop.counter }}: {{ question.text|linebreaksbr }}</strong></p>
            <span class="badge bg-secondary">{{ question.get_question_type_display }}</span>

            {% if question.question_type == 'MCQ' %}
            <ul class="list-unstyled mt-2">
                {% for option in question.options.all %}
                <li>
                    {{ option.text }}
                    {% if option.is_correct %}
                    <span class="badge bg-success">Correct</span>
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>
        {% empty %}
        <div class.list-group-item">
            <p>No questions have been added to this quiz yet.</p>
        </div>
        {% endfor %}
    </div>
</div>

<a href="{% url 'core:faculty_subject_detail' quiz.subject.pk %}" class="btn btn-secondary mt-3">Back to Subject</a>
{% endblock %}